<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Halperin Emoji Rating</title>

  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- Tailwind config (×œ×¤× ×™ ×™×™×‘×•× CSS!) -->
  <script>
    tailwind.config = {
      theme: { extend: { colors: { brandBlue: '#00B0F0' } } }
    };
  </script>

  <!-- Import map ×©××’×“×™×¨ ×××™×¤×” React ×™×’×™×¢ -->
  <script type="importmap">
  {
    "imports": {
      "react": "https://esm.sh/react@18.2.0",
      "react-dom/client": "https://esm.sh/react-dom@18.2.0/client"
    }
  }
  </script>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen">

  <div id="root"></div>

  <!-- ×”×§×•×“ ×¢×¦××• -->
  <script type="module">
    import React, { useState }      from 'react';
    import { createRoot }           from 'react-dom/client';

    /* ------------ ×”×§×•××¤×•× × ×˜×”  ------------ */
    const HalperinEmojiRating = () => {
      const [selected, setSelected] = useState(null);
      const [view, setView]         = useState('rating');   // rating|feedback|success
      const [pos, setPos]           = useState('');
      const [neg, setNeg]           = useState('');
      const [busy, setBusy]         = useState(false);

      const google = 'https://g.page/r/CRKQvqYdnP4sEBM/review';
      const ratings = [
        {v:5,e:'ğŸ˜',l:'××¦×•×™×Ÿ'},
        {v:4,e:'ğŸ˜Š',l:'×˜×•×‘ ×××•×“'},
        {v:3,e:'ğŸ˜',l:'×‘×¡×“×¨'},
        {v:2,e:'ğŸ˜•',l:'×¤×—×•×ª ×˜×•×‘'},
        {v:1,e:'ğŸ˜¢',l:'×××›×–×‘'}
      ];

      /* ×‘×—×™×¨×ª ×“×™×¨×•×’ */
      const choose = r => {
        setSelected(r);
        if (r.v === 5) {
          setView('success');                // ××¡×š ×ª×•×“×” ××©×›× ×¢
          setTimeout(()=>location.href=google, 4000);
        } else if (r.v === 4) {
          setView('success');                // ×ª×•×“×” ×§×¦×¨×”
        } else {
          setTimeout(()=>setView('feedback'), 250);
        }
      };

      /* ×©×œ×™×—×ª ××©×•×‘ */
      const submit = () => {
        if (!neg.trim() && !pos.trim()) return;
        setBusy(true);
        setTimeout(()=>{
          console.log({rating:selected.v, neg, pos, t:new Date().toISOString()});
          setBusy(false);
          setView('success');
        }, 1000);
      };

      /* ---------- SUCCESS ---------- */
      if (view === 'success') {
        if (selected?.v === 5) return (
          <div className="bg-white rounded-xl shadow p-6 max-w-sm text-center border border-gray-100">
            <div className="text-4xl mb-2">ğŸ‰</div>
            <h3 className="text-lg font-semibold mb-1">×ª×•×“×” ×¨×‘×” ×¢×œ ×”×“×™×¨×•×’ ×”××•×©×œ×!</h3>
            <p className="text-sm text-gray-600 mb-4">×“×¨×’×• ××•×ª× ×• ×‘-Google ×‘×œ×—×™×¦×” ××—×ª ğŸ˜‡</p>
            <a href={google} className="inline-block px-4 py-2.5 text-sm font-medium rounded-lg text-white"
               style={{background:'#00B0F0'}}>×œ×“×™×¨×•×’ ×‘-Google</a>
            <p className="text-xs text-gray-500 mt-3">× ×¢×‘×™×¨ ××ª×›× ××•×˜×•××˜×™×ª ×‘×¢×•×“ ×›××” ×©× ×™×•×ªâ€¦</p>
          </div>);
        if (selected?.v === 4) return (
          <div className="bg-white rounded-xl shadow p-6 max-w-sm text-center border border-gray-100">
            <div className="text-4xl mb-2">ğŸ™</div>
            <h3 className="text-lg font-semibold mb-1">×ª×•×“×” ×¢×œ ×”××©×•×‘ ×”×—×™×•×‘×™!</h3>
            <p className="text-sm text-gray-600">×©××—×™× ×©× ×”× ×™×ª× ğŸ™Œ</p>
          </div>);
        return (
          <div className="bg-white rounded-xl shadow p-6 max-w-sm text-center border border-gray-100">
            <div className="text-4xl mb-2">âœ…</div>
            <h3 className="text-lg font-semibold mb-1">×§×™×‘×œ× ×•, ×ª×•×“×”!</h3>
            <p className="text-sm text-gray-600">× ×¢×©×” ×”×›×•×œ ×œ×”×©×ª×¤×¨</p>
          </div>);
      }

      /* ---------- FEEDBACK ---------- */
      if (view === 'feedback') return (
        <div className="bg-white rounded-xl shadow p-6 max-w-sm border border-gray-100">
          <h3 className="text-base font-semibold mb-4">× ×©××— ×œ×©××•×¢ ××™×š × ×•×›×œ ×œ×”×©×ª×¤×¨ ğŸ™</h3>
          <div className="space-y-3">
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">××” × ×•×›×œ ×œ×©×¤×¨? ğŸ¯</label>
              <textarea rows="2" className="w-full text-sm border border-gray-200 rounded-lg px-3 py-2
                                             focus:outline-none focus:ring-2 focus:ring-brandBlue resize-none"
                        placeholder="×¡×¤×¨×• ×œ× ×• ××” ×¤×—×•×ª ×¢×‘×“"
                        value={neg} onChange={e=>setNeg(e.target.value)} />
            </div>
            <div>
              <label className="block text-sm font-medium text-gray-700 mb-1">××” ××”×‘×ª×? ğŸ’™</label>
              <textarea rows="2" className="w-full text-sm border border-gray-200 rounded-lg px-3 py-2
                                             focus:outline-none focus:ring-2 focus:ring-brandBlue resize-none"
                        placeholder="×¨×’×¢×™× ×˜×•×‘×™× ××• ×¦×•×•×ª ××¦×•×™×Ÿ"
                        value={pos} onChange={e=>setPos(e.target.value)} />
            </div>
            <button onClick={submit}
                    disabled={busy || (!neg.trim() && !pos.trim())}
                    className="w-full py-2.5 rounded-lg text-white text-sm font-medium disabled:opacity-50
                               flex items-center justify-center gap-1"
                    style={{background:'#00B0F0'}}>
              {busy ? '×©×•×œ×—â€¦' : <>âœ‰ï¸<span>×©×œ×— ××©×•×‘</span></>}
            </button>
          </div>
        </div>);

      /* ---------- RATING ---------- */
      return (
        <div className="bg-white rounded-xl shadow p-6 max-w-sm border border-gray-100">
          <h2 className="text-base font-semibold text-center mb-5 flex items-center justify-center gap-1">
            ××™×š ×”×™×™×ª×” ×”×—×•×•×™×” ×©×œ×›× ×‘×¡× ×™×£? ğŸ¤“
          </h2>
          <div className="flex justify-between gap-2">
            {ratings.map(r=>(
              <button key={r.v} onClick={()=>choose(r)}
                      className={`flex flex-col items-center gap-1 p-2 rounded-lg transition
                                  hover:scale-105
                                  ${selected?.v===r.v ? 'bg-blue-50 border-2 border-brandBlue' : 'hover:bg-gray-50'}`}
                      style={{minWidth:'54px'}}>
                <span className="text-2xl">{r.e}</span>
                <span className="text-[11px] text-gray-600 leading-tight">{r.l}</span>
              </button>
            ))}
          </div>
        </div>);
    };

    /* ×”×¨×¦×ª ×”××¤×œ×™×§×¦×™×” */
    createRoot(document.getElementById('root')).render(<HalperinEmojiRating />);
  </script>
</body>
</html>
