<!doctype html>
<html lang="he" dir="rtl">
<head>
  <meta charset="utf-8" />
  <title>Halperin Emoji Rating</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: { extend: { colors: { brandBlue: '#00B0F0' } } }
    };
  </script>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone@7/babel.min.js"></script>
</head>
<body class="bg-gray-50 flex items-center justify-center min-h-screen">
  <!-- Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ•Χ΅Χ¤Χ Χ§ΧΧΧ΅Χ™Χ Χ-root -->
  <div id="root" class="w-full sm:max-w-sm"></div>
  <script type="text/babel">
    const { useState, useEffect } = React;
    const { createRoot }          = ReactDOM;

    /* =============================== */
    const HalperinEmojiRating = () => {
      /* -------- state -------- */
      const [sel,   setSel]  = useState(null);
      const [view,  setView] = useState('rating');
      const [good,  setGood] = useState('');
      const [bad,   setBad]  = useState('');
      const [busy,  setBusy] = useState(false);
      const [secs,  setSecs] = useState(10);

      /* ----- constants ----- */
      const google = 'https://www.google.com/search?q=%D7%90%D7%95%D7%A4%D7%98%D7%99%D7%A7%D7%94+%D7%94%D7%9C%D7%A4%D7%A8%D7%99%D7%9F+%D7%9E%D7%A9%D7%A8%D7%93&client=ms-android-samsung-ss&sca_esv=09794bd27c0a5933&udm=1&biw=384&bih=726&sxsrf=AE3TifMscU3h3f4srxMDNA7LiddlbUdPvw%3A1748128777653&ei=CVQyaNDVJ-bhxc8P-vLlsQM&oq=%D7%90%D7%95%D7%A4%D7%98%D7%99%D7%A7%D7%94+%D7%94%D7%9C%D7%A4%D7%A8%D7%99%D7%9F+%D7%9E%D7%A9%D7%A8%D7%93&gs_lp=Ehltb2JpbGUtZ3dzLW1vZGVsZXNzLWxvY2FsIiTXkNeV16TXmNeZ16fXlCDXlNec16TXqNeZ158g157Xqdeo15MyCxAuGIAEGMcBGK8BSKkpUJ8YWKsncAB4AJABAJgB9wGgAdsIqgEFMC40LjK4AQPIAQD4AQGYAgagAogJwgIQEAAYgAQYQxiWARjHARiKBcICCxAAGIAEGJYBGMcBwgIIEAAYgAQYxwGYAwCIBgGSBwUwLjQuMqAH_jqyBwUwLjQuMrgHiAnCBwcwLjEuMy4yyAcp&sclient=mobile-gws-modeless-local#vhid=43:/g/11nwvty90w&vssid=reviews-collection-viewer-reviews-summary-entrypoint';

      const rates = [
        { v: 5, e: 'π', l: 'ΧΧ¦Χ•Χ™Χ' },
        { v: 4, e: 'π', l: 'ΧΧ•Χ‘ ΧΧΧ•Χ“' },
        { v: 3, e: 'π', l: 'Χ‘Χ΅Χ“Χ¨' },
        { v: 2, e: 'π•', l: 'Χ¤Χ—Χ•Χ ΧΧ•Χ‘' },
        { v: 1, e: 'πΆ', l: 'ΧΧΧ›Χ–Χ‘' }
      ];

      /* ----- choose rating ----- */
      const choose = r => {
        setSel(r);
        if (r.v === 5) {
          setSecs(10);
          setView('success');
          setTimeout(() => location.href = google, 10_000);
        } else if (r.v === 4) {
          setView('success');
        } else {
          setTimeout(() => setView('feedback'), 250);
        }
      };

      /* ----- send feedback ----- */
      const send = () => {
        if (!bad.trim() && !good.trim()) return;
        setBusy(true);
        setTimeout(() => {
          console.log({ rating: sel.v, bad, good, t: new Date().toISOString() });
          setBusy(false);
          setView('success');
        }, 1000);
      };

      /* ----- countdown effect ----- */
      useEffect(() => {
        if (view === 'success' && sel?.v === 5) {
          const id = setInterval(() => {
            setSecs(s => {
              if (s <= 1) { clearInterval(id); return 0; }
              return s - 1;
            });
          }, 1000);
          return () => clearInterval(id);
        }
      }, [view, sel]);

      /* ============ UI ============ */
      if (view === 'success') {
        if (sel?.v === 5) {
          return (
            // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ max-w-sm, Χ©Χ™Χ Χ•Χ™ p-6 Χ-p-4 sm:p-6
            <div className="bg-white rounded-xl shadow p-4 sm:p-6 text-center border border-gray-100">
              <h3 className="text-lg font-semibold mb-2">ΧΧ•Χ“Χ” Χ¨Χ‘Χ” ΧΆΧ Χ”Χ“Χ™Χ¨Χ•Χ’ Χ”ΧΧ•Χ©ΧΧ!</h3>
              <p className="text-sm text-gray-600 mb-4">ΧΧ—Χ¦Χ• ΧΆΧ Χ”Χ›Χ¤ΧΧ•Χ¨ Χ•Χ“Χ¨Χ’Χ• ΧΧ•ΧΧ Χ• Χ‘β€‘Google β€“ Χ–Χ” ΧΧΧ•Χ“ ΧΆΧ•Χ–Χ¨</p>
              <a href={google}
                 className="inline-block px-4 py-2.5 rounded-lg text-white text-sm font-medium"
                 style={{ background: '#00B0F0' }}>
                ΧΧ“Χ™Χ¨Χ•Χ’ Χ‘β€‘Google
              </a>
              <p className="text-xs text-gray-500 mt-4">Χ ΧΆΧ‘Χ™Χ¨ ΧΧΧ›Χ ΧΧ•ΧΧ•ΧΧΧ™Χ Χ‘ΧΆΧ•Χ“ {secs} Χ©Χ Χ™Χ•Χβ€¦</p>
            </div>
          );
        }

        if (sel?.v === 4) {
          return (
            // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ max-w-sm, Χ©Χ™Χ Χ•Χ™ p-6 Χ-p-4 sm:p-6
            <div className="bg-white rounded-xl shadow p-4 sm:p-6 text-center border border-gray-100">
              <h3 className="text-lg font-semibold mb-2">ΧΧ•Χ“Χ” ΧΆΧ Χ”ΧΧ©Χ•Χ‘ Χ”Χ—Χ™Χ•Χ‘Χ™!</h3>
              <p className="text-sm text-gray-600">Χ©ΧΧ—Χ™Χ Χ©Χ Χ”Χ Χ™ΧΧ ΧΧ”Χ©Χ™Χ¨Χ•Χ Χ©ΧΧ Χ•</p>
            </div>
          );
        }

        return (
          // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ max-w-sm, Χ©Χ™Χ Χ•Χ™ p-6 Χ-p-4 sm:p-6
          <div className="bg-white rounded-xl shadow p-4 sm:p-6 text-center border border-gray-100">
            <h3 className="text-lg font-semibold mb-2">Χ§Χ™Χ‘ΧΧ Χ•, ΧΧ•Χ“Χ”!</h3>
            <p className="text-sm text-gray-600">Χ”ΧΧ©Χ•Χ‘ Χ©ΧΧ›Χ Χ™ΧΆΧ–Χ•Χ¨ ΧΧ Χ• ΧΧ”Χ©ΧΧ¤Χ¨</p>
          </div>
        );
      }

      if (view === 'feedback') {
        return (
          // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ max-w-sm, Χ©Χ™Χ Χ•Χ™ p-6 Χ-p-4 sm:p-6
          <div className="bg-white rounded-xl shadow p-4 sm:p-6 border border-gray-100">
            <h3 className="text-base font-semibold mb-4">Χ Χ©ΧΧ— ΧΧ©ΧΧ•ΧΆ ΧΧ™Χ Χ Χ•Χ›Χ ΧΧ”Χ©ΧΧ¤Χ¨</h3>
            <div className="space-y-3">
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">ΧΧ” Χ Χ•Χ›Χ ΧΧ©Χ¤Χ¨?</label>
                <textarea rows="2" className="w-full text-sm border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brandBlue resize-none"
                          placeholder="Χ΅Χ¤Χ¨Χ• ΧΧ Χ• ΧΧ” Χ¤Χ—Χ•Χ ΧΆΧ‘Χ“" value={bad} onChange={e => setBad(e.target.value)} />
              </div>
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-1">ΧΧ” ΧΧ”Χ‘ΧΧ?</label>
                <textarea rows="2" className="w-full text-sm border border-gray-200 rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-brandBlue resize-none"
                          placeholder="Χ¨Χ’ΧΆΧ™Χ ΧΧ•Χ‘Χ™Χ ΧΧ• Χ¦Χ•Χ•Χ ΧΧ¦Χ•Χ™Χ" value={good} onChange={e => setGood(e.target.value)} />
              </div>
              <button onClick={send}
                      disabled={busy || (!bad.trim() && !good.trim())}
                      className="w-full py-2.5 rounded-lg text-white text-sm font-medium disabled:opacity-50"
                      style={{ background: '#00B0F0' }}>
                {busy ? 'Χ©Χ•ΧΧ—β€¦' : 'Χ©ΧΧ— ΧΧ©Χ•Χ‘'}
              </button>
            </div>
          </div>
        );
      }

      /* rating view */
      return (
        // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ max-w-sm, Χ©Χ™Χ Χ•Χ™ p-6 Χ-p-4 sm:p-6
        <div className="bg-white rounded-xl shadow p-4 sm:p-6 border border-gray-100">
          <h2 className="text-base font-semibold text-center mb-5">ΧΧ™Χ Χ”Χ™Χ™ΧΧ” Χ”Χ—Χ•Χ•Χ™Χ” Χ©ΧΧ›Χ Χ‘Χ΅Χ Χ™Χ£?</h2>
          <div className="flex justify-between gap-2">
            {rates.map(r => (
              // Χ©Χ™Χ Χ•Χ™ Χ›ΧΧ: Χ”Χ΅Χ¨Χ style Χ•Χ”Χ•Χ΅Χ¤Χ flex-1
              <button key={r.v} onClick={() => choose(r)}
                      className={`flex flex-1 flex-col items-center gap-1 p-2 rounded-lg transition hover:scale-105 ${sel?.v === r.v ? 'bg-blue-50 border-2 border-brandBlue' : 'hover:bg-gray-50'}`}>
                <span className="text-2xl">{r.e}</span>
                <span className="text-[11px] text-gray-600 leading-tight">{r.l}</span>
              </button>
            ))}
          </div>
        </div>
      );
    };

    /* mount */
    createRoot(document.getElementById('root')).render(<HalperinEmojiRating />);
  </script>
</body>
</html>
